<div class="row">
  <div class="sidebar-fixed border-end pe-3">
    <%# Sidebar partial'ını buraya dahil ediyoruz %> <%-
    include('partials/_sidebar') %>
  </div>

  <div class="content-area">

    <div class="tabs-wrapper mb-4">
      <ul class="nav nav-tabs border-0">
        <li class="nav-item">
          <a class="nav-link active" href="?tab=foryou">Sana Özel</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="?tab=featured">Öne Çıkanlar</a>
        </li>
      </ul>
      <hr class="mt-0 mb-3" />
    </div>


    <h1 class="mb-4 visually-hidden">Anasayfa</h1>
    <% if (news && news.length > 0) { %> <% news.forEach(news => { %>

    <div class="card mb-4 shadow-sm overflow-hidden">
      <div class="row g-0">
        <div class="col-md-4">
          <% const imageSource = news.imageUrl ? '/uploads/' + news.imageUrl :
          'https://via.placeholder.com/300x200?text=NewsHub'; %>
          <a href="/news/<%= news._id %>">
            <img
              src="<%= imageSource %>"
              class="img-fluid rounded-start w-100 h-100 object-fit-cover"
              alt="<%= news.title %>"
              style="min-height: 180px"
            />
          </a>
        </div>
        <div class="col-md-8">
          <div class="card-body d-flex flex-column h-100">
            <p class="card-text mb-1">
              <small class="text-body-secondary">
                <%= news.author ? news.author.name : 'Bilinmeyen Yazar' %> - <%=
                new Date(news.createdAt).toLocaleDateString('tr-TR', { day:
                'numeric', month: 'long' }) %> <% if (news.category &&
                news.category !== 'Diğer') { %>
                <span class="badge bg-secondary ms-1"
                  ><%= news.category %></span
                >
                <% } %>
              </small>
            </p>
            <h5 class="card-title news-title mb-2">
              <%# mb-1 yerine mb-2 %>
              <a href="/news/<%= news._id %>"><%= news.title %></a>
            </h5>
            <p class="card-text text-secondary">
              <% const snippet = news.content.length > 100 ?
              news.content.replace(/<[^>]*>/g, '').substring(0, 100) + '...' :
              news.content.replace(/<[^>]*>/g, ''); %> <%= snippet %>
            </p>
            <p class="card-text mt-auto">
              <a href="/news/<%= news._id %>" class="text-primary fw-semibold"
                >Devamını Oku →</a
              >
            </p>
          </div>
        </div>
      </div>
      
    </div>
    
    


    <% }) %> <% } else { %>
    <div class="text-center p-5 border rounded bg-light">
      <p class="lead">Henüz hiç yazı yayınlanmamış.</p>
      <% if (user && user.id) { %>
      <a href="/news/new" class="btn btn-primary mt-3">İlk Yazıyı Sen Ekle</a>
      <% } %>
    </div>
    <% } %>
  </div>
</div>

